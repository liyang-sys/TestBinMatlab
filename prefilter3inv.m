function y=prefilter3inv(y,S,P,U)

y(5:8,:)=y(5:8,:)-flipud(y(1:4,:));
y(1:4,:)=y(1:4,:)+flipud(y(5:8,:))/2;

y(5,:)=y(5,:)-U(1)*y(6,:);  y(6,:)=y(6,:)-P(1)*y(5,:);   
y(6,:)=y(6,:)-U(2)*y(7,:);  y(7,:)=y(7,:)-P(2)*y(6,:);  
y(7,:)=y(7,:)-U(3)*y(8,:);  y(8,:)=y(8,:)-P(3)*y(7,:);   
y(5,:)=y(5,:)/S(1);  y(6,:)=y(6,:)/S(2);  y(7,:)=y(7,:)/S(3);  y(8,:)=y(8,:)/S(4);

y(1:4,:)=y(1:4,:)-flipud(y(5:8,:))/2;
y(5:8,:)=y(5:8,:)+flipud(y(1:4,:));
